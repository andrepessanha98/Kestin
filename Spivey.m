clear all
close all
clc
%Script to test an algorythim that calculates Viscosity using Kestin Model%
T=125;
T2=[27.5 44.5 60.0 80.0 94.0 101.0 131.0 148.0];
P = [0.93 3.48 6.95 10.65 14.11 17.60 20.96 24.61 27.82 31.09 15.62 0.1 ;  0.10 3.50 7.12 11.03 14.24 17.65 20.81 24.39 27.86 31.3 17.39 0.10 ; 0.10 3.33 7.26 10.51 13.72 17.75 21.08 23.15 27.47 31.39 15.60 0.10 ; 0.86 3.45 7.01 10.44 13.89 17.34 20.86 24.30 27.68 31.27 21.46 11.06 ; 1.02 3.47 6.82 10.39 13.76 17.25 20.92 24.29 27.96 31.28 16.17 1.43 ; 1.38 3.55 7.13 10.72 13.99 17.58 21.13 24.44 27.68 31.37 15.58 8.84 ; 1.55 3.48 6.93 10.58 13.99 17.44 20.79 24.39 27.54 31.54 15.65 1.55 ; 3.67 7.13 10.46 13.82 17.39 21.04 24.34 27.73 31.27 16.17 0.77 nan];
S=5.4054;
A = Am(S);
B = Bm(S);
C = Cm(T);
M = C+log10(1002);
M0 = A + B.*C;
Milog=M0+M;
Mi = 10.^(Milog);
bw = Bw(T);
bs = Bs(T,bw);
Ms = ms(T);
bp = Bp(S,Ms);
Beta = bw+bp.*bs;
Visc1 = Viscosityspiveypure(P,Mi,Beta);
Visc2 = SpiveyVisc(T2,P,Visc1);